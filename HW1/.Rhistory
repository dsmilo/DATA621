plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fitall <- lm(TARGET_WINS ~. , df)
summary(fitall)
model<- lm(TARGET_WINS ~TEAM_BATTING_H+poly(TEAM_FIELDING_DP,2)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
model<- lm(TARGET_WINS ~poly(TEAM_BATTING_H,2)+poly(TEAM_FIELDING_DP,2)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
model<- lm(TARGET_WINS ~poly(TEAM_BATTING_H,3)+poly(TEAM_FIELDING_DP,3)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
model<- lm(TARGET_WINS ~poly(TEAM_BATTING_H,3)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
x=c(1,150)
abline(x,y, col='red')
abline(x=x,y=y, col='red')
y=x
abline(x=x,y=y, col='red')
x=c(1,150)
y=x
abline(x=x,y=y, col='red')
y
x=c(1:150)
y=x
abline(x=x,y=y, col='red')
y
x
df5=cbind(x,y)
abline(df5, col='red')
df5
abline(df5$x,df5$y, col='red')
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~TEAM_BATTING_H+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~poly(TEAM_BATTING_H,1/3)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
model<- lm(TARGET_WINS ~poly(TEAM_BATTING_H,1/3)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(model)
model<- lm(TARGET_WINS ~ TEAM_BATTING_H + I(TEAM_BATTING_H^2) + I(TEAM_BATTING_H^3)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
model<- lm(TARGET_WINS ~ TEAM_BATTING_H + I(TEAM_BATTING_H^(1/2)) + I(TEAM_BATTING_H1^(1/3))+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
hist(TARGET_WINS, df)
hist(df$TARGET_WINS, df)
hist(df$TARGET_WINS)
hist(df$TARGET_WINS)
model<- lm(TARGET_WINS ~ TEAM_BATTING_H + I(TEAM_BATTING_H^(1/2)) + I(TEAM_BATTING_H1^(1/3))+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
head(df_predict)
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
abline(x,fit1, col='red')
fit1
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~ TEAM_BATTING_H + sqrt(TEAM_BATTING_H)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~ TEAM_BATTING_H + exp(TEAM_BATTING_H)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  exp(TEAM_BATTING_H)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  sqrt(TEAM_BATTING_H)+TEAM_FIELDING_DP+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  sqrt(TEAM_BATTING_H)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  log(TEAM_BATTING_H)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,2)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_FIELDING_E , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_FIELDING_E,3) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(model)
```{r}
fitall <- lm(TARGET_WINS ~. , df)
summary(fitall)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_PITCHING_H, 3) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  sqrt(TEAM_BATTING_H,3)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  sqrt(TEAM_BATTING_H)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  exp(TEAM_BATTING_H)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,9)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,20)+TEAM_PITCHING_H , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,20)+poly(TEAM_PITCHING_H,5) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,21)+poly(TEAM_PITCHING_H,5) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_PITCHING_H,5) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+sqrt(TEAM_PITCHING_H) , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
summary(fitall)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H+TEAM_FIELDING_E+TEAM_FIELDING_DP , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_PITCHING_H,3)+TEAM_FIELDING_E+TEAM_FIELDING_DP , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_PITCHING_H,3)+poly(TEAM_FIELDING_E,3)+TEAM_FIELDING_DP , df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
pairs(df)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+poly(TEAM_PITCHING_H,3)+poly(TEAM_BATTING_SO,3)+TEAM_FIELDING_DP, df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H+poly(TEAM_BATTING_SO,3)+TEAM_FIELDING_DP, df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H+TEAM_BATTING_SO+TEAM_FIELDING_DP, df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(model, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
fit1 <- lm(TARGET_WINS~.-TEAM_PITCHING_HR-TEAM_BATTING_SO-TEAM_BATTING_H, df)#
summary(fit1)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(fitall, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
df_no_outliers = remove_outliers(df)
for (i in 1:16){
df[,i] = remove_outliers(df[,i])
}
df
boxplot(df)
install.packages("MIPHENO")
library(MIPHENO)
new_df=re.outliers(df)
library(MIPHENO)
new_df=re.outliers(df)
new_df=rm.outliers(df)
new_df
boxplot(new_df)
raw_data <- read.csv(url("https://raw.githubusercontent.com/dsmilo/DATA621/master/HW1/data/moneyball-training-data.csv"))
raw_data <- raw_data[,c(2:17)] # delete index
str(raw_data)
summary(raw_data)
df = raw_data[-which(raw_data$TEAM_PITCHING_SO>=5832),]
for (i in 1:16){
df[,i][is.na(df[,i])] <-  median(df[,i], na.rm = TRUE)
}
summary(df)
View(cor(df))
hist(df$TARGET_WINS)
source('~/.active-rstudio-document', echo=TRUE)
library(MIPHENO)
new_df=rm.outliers(df)
boxplot(new_df)
summary(new_df)
str(new_df)
str(df)
library(outlier)
install.packages("outlier")
install.packages("outliers")
library(outliers)
new_df <- rm.outlier(df)
for (i in 1:16){
df[,i] <- rm.outlier(df[,i])
}
df
str(df)
boxplot(df)
df = raw_data[-which(raw_data$TEAM_PITCHING_SO>=5832),]
for (i in 1:16){
df[,i][is.na(df[,i])] <-  median(df[,i], na.rm = TRUE)
}
summary(df)
View(cor(df))
hist(df$TARGET_WINS)
test_df=df
library(outliers)
for (i in 1:16){
test_df[,i] <- rm.outlier(test_df[,i])
}
test_df=df
for (i in 1:16){
outlier_tf1 = outlier(test_df[,i],logical=TRUE)
find_outlier1 = which(outlier_tf1==TRUE, arr.ind=TRUE)
test_new = test_df[-find_outlier1]
}
test_new
str(test_new)
boxplot(test_df)
boxplot(df)
outlier_tf1 = outlier(test_df[,1],logical=TRUE)
outlier_tf1
outlier_tf1 = outlier(test_df[,2],logical=TRUE)
outlier_tf1
outliers = which(outlier(test_df[,i],logical=TRUE))
outliers
outliers = which(outlier(test_df[,1],logical=TRUE))
outliers
outliers = which(outlier(test_df[,2],logical=TRUE))
outliers
outliers = which(outlier(test_df[,2]))
outlier(test_df[,2],logical=TRUE)
outliers = which(outlier(test_df[,2],logical=TRUE))
outliers
outliers = which(outlier(test_df[,10],logical=TRUE))
outliers
outliers = which(outlier(test_df[,12],logical=TRUE))
outliers
outliers = which(outlier(test_df[,16],logical=TRUE))
outliers
outliers = which(outlier(test_df[,16],logical=TRUE))
outliers
outliers = which(outlier(test_df[,12],logical=TRUE))
outliers
for (i in 1:16){
outliers = which(outlier(test_df[,12],logical=TRUE))
test_df = test_df[-outliers,]
}
str(test_df)
for (i in 1:16){
outliers = which(outlier(test_df[,i],logical=TRUE))
test_df = test_df[-outliers,]
}
str(test_df)
boxplot(test_df)
boxplot(test_df$TEAM_PITCHING_HR)
library(outliers)
for (i in 1:16){
outliers = which(outlier(test_df[,i],logical=TRUE))
new_df = new_df[-outliers,]
}
str(new_df)
fitall <- lm(TARGET_WINS ~. , new_df)
summary(fitall)
mary(fitall)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H+TEAM_BATTING_SO+TEAM_FIELDING_DP, new_df)
summary(model)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H+TEAM_BATTING_SO+TEAM_FIELDING_DP, new_df)
summary(model)
model<- lm(TARGET_WINS ~  TEAM_BATTING_H+TEAM_PITCHING_H+TEAM_BATTING_SO+TEAM_FIELDING_DP, new_df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(fitall, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
summary(fit1)
pairs(df)
model<- lm(TARGET_WINS ~  TEAM_BATTING_H+TEAM_PITCHING_H, new_df)
summary(model)
df_predict <- data.frame(cbind(original=df$TARGET_WINS, predicted=predict(fitall, df)))
plot(df_predict$original, df_predict$predicted, xlim=c(0,150), ylim=c(0,150))
fit1=lm(df_predict$predicted~df_predict$original)
x=c(1:150)
y=x
df5=data.frame(cbind(x,y))
abline(df5$x,df5$y, col='red')
plot(model)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,3)+TEAM_PITCHING_H, new_df)
plot(model)
model<- lm(TARGET_WINS ~  poly(TEAM_BATTING_H,2)+TEAM_PITCHING_H, new_df)
plot(model)
model<- lm(TARGET_WINS ~  sqrt(TEAM_BATTING_H)+TEAM_PITCHING_H, new_df)
plot(model)
