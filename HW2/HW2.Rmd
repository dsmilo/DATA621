```{r}
raw <- read.csv(url("https://raw.githubusercontent.com/dsmilo/DATA621/master/HW2/Data/classification-output-data.csv"))
(ctable <- table(raw[ , c(10,9)])) #Columns are
(cm <- as.data.frame.matrix(ctable))
(cm <- cm[2:1,2:1]) #Reorder table to follow positives in top left convention, negatives on bottom right. 

#________Actual Pos   Neg
#Pred Positive [TP    FP]
#Pred Negative [FN    TN]

confusion <- function(df){
  df <- as.data.frame.matrix(table(df[,c("scored.class","class")]))
  df[2:1,2:1] #Reorder table to follow positives in top left convention, negatives on bottom right.
}

accuracy <- function(df){
  cm <- confusion(df)
  (cm[1,1] + cm[2,2])/sum(cm[,])
}

erroneousness <- function(df){
  cm <- confusion(df)
  (cm[1,2] + cm[2,1])/sum(cm[,])
}

accuracy(df) + erroneousness(df) == 1

precision <- function(df){
  cm <- confusion(df)
  cm[1,1]/sum(cm[1,])
}

sensitivity <- function(df){
  cm <- confusion(df)
  cm[1,1]/sum(cm[,1])
}

specificity <- function(df){
  cm <- confusion(df)
  cm[2,2]/sum(cm[,2])
}

F1 <- function(df){
  2*precision(df)*sensitivity(df)/(precision(df) + sensitivity(df))
}
```
